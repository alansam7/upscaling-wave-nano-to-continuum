# variables modifiable using -var command line switch

variable	temp equal 300.00 # in K
# Define the driving force grad mu =F, CAVE: acts on each water molecule! # ALAN
variable	F    index  10.0 # pN, per water  # ALAN

variable	dumptime   equal 200   
variable	timestep   equal 1.00
variable	thermotime equal 100
variable	damp       equal 200 

processors    * * *

# global model settings

units           real
boundary        p p p  
atom_style      full
bond_style      harmonic
angle_style     harmonic

#log             outputFiles/${irun}.${F}.flex.log

# cuttof de 13
pair_style      lj/cut/coul/long 13 13   # change here BEN 

# lj parameters
#
variable        Otype   equal 1
variable        Sitype  equal 2
variable        CH4type equal 3

# box

read_data       config.new
kspace_style    pppm 1.0e-5

#param skoulidas

pair_coeff      ${Otype} ${Otype} 0.190865731 3.107819135
pair_coeff      ${Otype} ${Sitype} 0.000393704 3.416463223
pair_coeff      ${Otype} ${CH4type}     0.2647 3.214
pair_coeff      ${Sitype} ${Sitype} 0.000001646853 3.344780302
pair_coeff      ${Sitype} ${CH4type}    0 0
pair_coeff      ${CH4type} ${CH4type}   0.2938 3.73

group           fluid type ${CH4type}
group           zeolite type ${Sitype} ${Otype}

timestep	${timestep}

fix             fxzeolite  zeolite  setforce 0.0 0.0 0.0
minimize        1.0e-4 1.0e-6 1000 10000
unfix		fxzeolite
reset_timestep  0


# only use the y-z directions for computing the water temperature # ALAN
compute 	fluidTemp fluid temp/partial 0 1 1 # ALAN
neigh_modify    delay 5   

fix 		fxnve fluid nve
fix             fxnvt zeolite nvt temp ${temp} ${temp} ${damp}
fix             myzeoframe zeolite recenter INIT INIT INIT shift all
fix             myzeovelo zeolite momentum 100 linear 1 1 1

# Apply the driving force only to the water oxygens... # ALAN
variable        forcefac equal 0.01439 # pN in kcal/mol/A # ALAN
variable        extforce equal $(v_F*v_forcefac)     # ALAN
fix             fxtmp fluid temp/rescale 10 300 300 1 1.0
fix             pressure fluid addforce ${extforce} 0 0 # ALAN

thermo          ${thermotime}
thermo_modify   flush yes

run             100000
reset_timestep  0
unfix		fxtmp

dump            dmp fluid custom ${dumptime} outputFiles/flex.dump.lammpstrj id type x y z vx vy vz 
dump_modify     dmp flush yes sort id format line "%d %d %.6f %.6f %.6f %.6f %.6f %.6f"

#minimize 1.0e-6 1.0e-8 1000 100000
run		5000000
write_data	data.flex.end.txt 


