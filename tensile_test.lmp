# variables modifiable using -var command line switch

variable        temp index 300  #K

# global model settings

units           real
boundary	p p p 
atom_style      full
bond_style	harmonic
angle_style     harmonic

# cuttof de 13
pair_style      lj/cut/coul/long 13 13   # change here BEN 

# lj parameters

variable	Otype	equal 1
variable	Sitype	equal 2
variable	CH4type equal 3

variable        dt equal 0.5 #  fs

# box

read_data	config.new
kspace_style	pppm 1.0e-5 

#param skoulidas

pair_coeff      ${Otype} ${Otype} 0.190865731 3.107819135
pair_coeff      ${Otype} ${Sitype} 0.000393704 3.416463223
pair_coeff      ${Otype} ${CH4type}     0.2647 3.214
pair_coeff      ${Sitype} ${Sitype} 0.000001646853 3.344780302
pair_coeff      ${Sitype} ${CH4type}    0 0
pair_coeff      ${CH4type} ${CH4type}   0.2938 3.73 

group		fluid type ${CH4type}
group 		zeolite type ${Sitype} ${Otype}

timestep 	${dt}


#----------------------COMPUTES-----------------------------
compute         1 all stress/atom NULL
compute         2 all reduce sum c_1[1] c_1[2] c_1[3] c_1[4] c_1[5] c_1[6]

variable        Lx equal "lx"
variable        Ly equal "ly"
variable        Lz equal "lz"
variable        LX equal ${Lx}
variable        LY equal ${Ly}
variable        LZ equal ${Lz}
variable        Vol equal vol

fix             mynvt  all nvt temp ${temp} ${temp} $(10.0*dt)
fix             myzeoframe zeolite recenter INIT INIT INIT shift all
fix             myzeovelo zeolite momentum 100 linear 1 1 1

thermo          2000
run             100000
#-----------------------DEFORMATION---------------------
reset_timestep  0

fix             2 all ave/time 1 100 100 c_2[1] c_2[2] c_2[3] c_2[4] c_2[5] c_2[6]
fix             3 all ave/time 1 100 100 v_LX v_LY v_LZ v_Vol
variable        srate equal 1.0e9
variable        srate1 equal "v_srate / 1.0e15"
fix             4 all deform 1 x erate ${srate1} units box remap x
#fix             4 all deform 1 xz erate ${srate1} units box remap x
run             100

#-----------------------THERMO-OUTPUTS--------------------------------------

variable        CorVol equal "v_LX*v_LY*v_LZ"
variable        ConvoFac equal 1.01325/1.0e4
variable        sigmaxx equal f_2[1]*v_ConvoFac/v_CorVol
variable        sigmayy equal f_2[2]*v_ConvoFac/v_CorVol
variable        sigmazz equal f_2[3]*v_ConvoFac/v_CorVol
variable        tauyz equal f_2[4]*v_ConvoFac/v_CorVol
variable        tauxz equal f_2[5]*v_ConvoFac/v_CorVol
variable        tauxy equal f_2[6]*v_ConvoFac/v_CorVol
variable        StrainPerTs equal v_srate1*v_dt
variable        strain equal v_StrainPerTs*step
thermo          100
thermo_style    custom step temp v_strain v_sigmaxx v_sigmayy v_sigmazz v_tauyz v_tauxz v_tauxy pe ke lx ly lz vol


fix             def1 all print 100 "${strain} ${sigmaxx} ${sigmayy} ${sigmazz} ${tauyz} ${tauxz} ${tauxy}" file Cijkl_x.txt screen no
dump            1 all atom 5000 tensile_test_x.lammpstrj
run             500000
